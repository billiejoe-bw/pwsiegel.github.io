---
layout: post
permalink: /category-theory/monads/
title: Monads
abstract: 
level: hard
date: 2017-09-10
categories: stage
comments: true
---

## Examples of (co)monads

Recall that an [adjunction][1] between categories $\C$ and $\D$ consists of a pair of functors $F \colon \D \to \C$ and $G \colon \C \to \D$ together with unit/counit natural transformations

$$u \colon 1_\D \to GF \quad \text{and} v \colon FG \to 1\_C$$

which satisfy some axioms.

One can think of $F$ and $G$ as being "almost inverses", with the unit/counit pair measuring how far they are from being actual inverses.
Given this setup, the functor $GF$ is an example of a monad, and $FG$ is an example of a comonad.
(Of course a (co)monad is not just a bare functor - one considers the unit and counit to be part of the structure.)

In fact, this is the only source of examples of monads and comonads.
We will provide axiomatic definitions of both terms later on, but it is a theorem that every (co)monad satisfying those axioms is inducd by an adjunction (in fact many adjunctions in general) as described above.

### Example: the product monad

Let us begin by examining the monad and comonad associated to the product / diagonal adjunction constructed in my [post][1] on adjunctions.
This adjunction consisted of the product functor $P \colon \Set^2 \to \Set$ which sends a pair of sets to their product together with its left adjoint, the diagonal functor $\Delta \colon \Set \to \Set^2$.

The monad associated to this adjunction is the functor

$$P \Delta \colon \Set \to \Set$$

which sends an object $X$ to $X \times X$ and a morphism $f$ to the morphism $f \times f$.

The comonad associated to this adjunction is the functor

$$\Delta P \colon \Set^2 \to \Set^2$$

which sends a pair of sets $(X, Y)$ to $(X \times Y, X \times Y)$ and a pair of functions $(f, g)$ to the $(f \times g, f \times g)$.

We will discuss the role that the counit and unit natural transformations play in these constructions later on.

### Example: Galois connections

Recall that a Galois connection is an adjunction between two posets (equipped with their natural category structures).
In my [post][2] on the subject, I went through the proof that a Galois connection between $(A, \leq_A)$ and $(B, \leq_B)$ is the same thing as a pair of increasing functions $F \colon B \to A$ and $G \colon A \to B$ with the property that

$$
\begin{equation} \label{gal_connection}
   F(b) \leq_A a \iff b \leq_A G(a)
\end{equation}
$$

for every $a \in A$, $b \in B$.

What is a monad in this language?
Let us show that the functor $M = GF$ satisfies three axioms:

- $M$ is **increasing**: $M(b_1) \leq_B M(b_2)$ whenever $b_1 \leq_B b_2$.

This follows from the fact that $F$ and $G$ are increasing (which in turn follows from the fact that $F$ and $G$ are functors).

- $M$ is **extensive**: $M(b) \leq_B b$ for all $b \in B$.

Indeed, we have $F(b) \leq_A F(b)$ by reflexivity, and thus $GF(b) \leq_B b$ by \eqref{gal_connection}.

- $M$ is **idempotent**: $M^2(b) = M(b)$ for all $b \in B$.

To prove this, note that $M^2(b) \leq_B M(b)$ since $M$ is extensive.
Moreover $F(b) \leq_A FGF(b)$ by \eqref{gal_connection} applied to the reflexive inequality $GF(b) \leq_B GF(b)$, and thus $GF(b) \leq_B GFGF(b)$ since $G$ is increasing.
This is equivalent to $M(b) \leq_B M^2(B)$, so we conclude that $M(b) = M^2(B)$ by antisymmetry of $\leq_B$.

A function $M$ which satisfies the three axioms above is traditionally called a **closure operator**, so we have shown that for any Galois connection $(F, G)$ the corresponding monad $M = GF$ is a closure operator.
It will follow from more general considerations involving the relationship between adjunctions and monads that every closure operator comes from a Galois connection as above, so in fact the monads on a poset are precisely the closure operators on that poset.

<div class="exercise">
Show that the comonad $FG$ is a closure operator on the poset obtained by reversing the partial ordering $\leq_A$ on $A$.
</div>

## The Monad Axioms

It is entirely possible to develop the theory of monads from the point of view that a monad is the composition of the right adjoint functor with the left adjoint functor coming from an adjunction between two categories.
But this definition is unsatisfactory since many different adjunctions can give rise to the same monad and thus it is difficult to see what the monad itself actually is.
In this section we will define monads axiomatically and then show that the construction via adjunctions satisfies the axioms.
In a future post we will show that every monad in the sense of the axioms comes from an adjunction, so that the two possible definitions are equivalent.

<div class="definition">
Let $\D$ be a category.
A **monad** on $\D$ is a functor $M \colon \D \to \D$ equipped with a pair of natural transformations $u \colon 1\_\D \to M$ and $j \colon M^2 \to M$ called the **unit** and **join** transformations, respectively, which satisfy the following coherence conditions:

$$
j \circ Mj = j \circ jM 
$$

as natural transformations $M^3 \to M$ and:

$$
j \circ Mu = j \circ uM = 1_M 
$$

as natural transformations $M \to M$.
</div>

<div class="lemma">
Let $F \colon \D \to \C$ be a functor which is left adjoint to $G \colon \C \to \D$ via the unit $u \colon 1\_\D \to GF$ and counit $v \colon FG \to 1\_\C$.  Then $M = GF$ equipped with the unit $u$ and join $j = GvF$ is a monad in the sense of the definition above.
</div>
<div class="proof">
Note that $j$ is the natural transformation $GFGF \to GF$ whose component at an object $D$ of $\D$ is the morphism $G(v\_{F(D)})$.
So $j$ is indeed a natural transformation $M^2 \to M$, and we must show that $M$, $u$, and $j$ satisfy the coherence conditions.

Let us begin with the identity $j \circ Mj = j \circ jM$.
$Mj$ is a natural transformation $M^3 \to M^2$; using our formula for the component of $j$ at an object $D$ we get:

$$
(Mj)_D = M(j_D) = M(G(v_{F(D)})) = GFG(v_{F(D)}) 
$$

Similarly, the component of $jM \colon M^3 \to M^2$ at $D$ is:

$$
(jM)_D = j_{M(D)} = G(v_{F(M(D))}) = G(v_{FGF(D)})
$$

Thus we have:

$$
\begin{align*}
(j \circ Mj)_D &= j_D \circ (Mj)_D \\
&= G(v_{F(D)}) \circ GFG(v_{F(D)}) \\
&= G(v_{F(D)} \circ FG(v_{F(D)})) \\
\end{align*}
$$
</div>








[1]:
[2]:
